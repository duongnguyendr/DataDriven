package com.auvenir.utilities.htmlreport.com.nxgreport.writer;

import com.auvenir.utilities.htmlreport.com.nxgreport.ReportLabels;
import com.auvenir.utilities.htmlreport.com.nxgreport.utils.TestDirectory;

import java.io.PrintWriter;

/**
 * Created by tan.pham on 6/26/2017.
 */
public class IndexPageWriter {
    public IndexPageWriter() {
    }

    public static void printHeader(PrintWriter printWriter) {
        printWriter.println("<!DOCTYPE html>\n<html>\n\t<head>\n\t\t<title>Execution Summary</title>\n\n\t\t<link rel=\"stylesheet\" type=\"text/css\" href=\"" + TestDirectory.RESOURCESDIRName + "/" + TestDirectory.CSSDIRName + "/design.css\" />\n\n" + "\t\t<script src=\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js\"></script>" + "     <link rel=\"stylesheet\" href=\"https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css\">" + "\t\t<script src=\"https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js\"></script>" + "     <script src=\"Resources/Js/amcharts.js\" type=\"text/javascript\"></script>" + "\t\t<script src=\"Resources/Js/serial.js\" type=\"text/javascript\"></script>" + "\t\t<script src=\"Resources/Js/runData.js\" type=\"text/javascript\"></script>" + "\n<style>" + "\n.kchart{width:800px;height:500px;}" + "\n</style>" + " \n   <script>" + " \n   $(function() {" + " \n     $( '#tabs' ).tabs();" + " \n   });" + " \n   </script>" + "</head>\n " + "<body>\n" + "\t\t<table id=\"mainTable\">\n" + "\t\t\t<tr id=\"header\" >\n" + "\t\t\t\t<td id=\"logo\"><img src=\"" + TestDirectory.RESOURCESDIRName + "/" + TestDirectory.IMGDIRName + "/" + "Auvenir_01.png" + "\" alt=\"Logo\" height=\"70\" width=\"140\" /> " + "<br/>" + ReportLabels.CAPTION.getLabel() + "</td>\n" + "\t\t\t\t<td id=\"headertext\">\n" + ReportLabels.HEADER_TEXT.getLabel() + "\n" + "\t\t\t\t\t</div>" + "\t\t\t\t</td>\n" + "\t\t\t</tr>\n" + "\t\t\t<tr id=\"container\">\n" + "\t\t\t\t<td id=\"menu\">\n\n" + "\t\t\t\t\t<ul class='mmmenu'>\n");
        printWriter.println("</ul>\t\t\t\t</td>");
    }

    public static void printContent(PrintWriter printWriter, String description) {
        printWriter.println("<td id=\"content\">\n");
        printWriter.print(description);
        printWriter.println("\n\t\t<div id='tabs'> \n\t\t  <ul> \n\t\t\t<li><a href='#tabs-1'>Line Chart</a></li> \n\t\t\t<li><a href='#tabs-2'>Bar Chart</a></li> \n\t\t  </ul> \n\t\t  <div id='tabs-1'> \n\t\t\t\t<div class='kchart chartStyle' id='myLineChart'></div> \n\t\t  </div> \n\t\t  <div id='tabs-2'> \n\t\t\t<div class='kchart chartStyle' id='myBarChart'></div> \n\t\t  </div> \n\t\t</div>\n<script>\t\n  \tvar chartData = [];\n $(function() {\t\tfor(var menu in chartData){$('.mmmenu').append('<li><a href=\"Run_'+chartData[menu].date +'/Result.html\">'+chartData[menu].displayname+'</li>');}}) \n\t\tchartData =getChartDataForMe();\t\n  \tvar chart = AmCharts.makeChart('myLineChart', {\t\n  \t\t'type': 'serial',\t\n  \t\t'theme': 'light',\t\n  \t\t'marginRight': 20,\t\n  \t\t'autoMarginOffset': 20,\t\n  \t\t'marginTop': 7,\t\n  \t\t'dataProvider': chartData,\t\n  \t\t'valueAxes': [{\t\n  \t\t\t'axisAlpha': 0.2,\t\n  \t\t\t'dashLength': 1,\t\n  \t\t\t'position': 'left'\t\n  \t\t}],\t\n  \t\t'graphs': [{\t\n  \t\t\t'id': 'g1',\t\n  \t\t\t'balloonText': '[[category]]<br/><b><span style=\"font-size:14px;\">Passed: [[value]]</span></b>',\t\n  \t\t\t'bullet': 'round',\t\n  \t\t\t'bulletBorderAlpha': 1,\t\n  \t\t\t'bulletColor': '#FFFFFF',\t\n  \t\t\t'hideBulletsCount': 50,\t\n  \t\t\t'title': 'red line',\t\n  \t\t\t'valueField': 'Passed',\t\n  \t\t\t'useLineColorForBulletBorder': true,\t\n  \t\t\t'lineColor': '#0F9D28',\t\n  \t\t\t'lineThickness': 2\t\n  \t\t},\t\n  \t\t\t\t  {\t\n  \t\t\t'id': 'g2',\t\n  \t\t\t'balloonText': '[[category]]<br/><b><span style=\"font-size:14px;\">Failed: [[value]]</span></b>',\t\n  \t\t\t'bullet': 'round',\t\n  \t\t\t'bulletBorderAlpha': 1,\t\n  \t\t\t'bulletColor': '#FFFFFF',\t\n  \t\t\t'hideBulletsCount': 50,\t\n  \t\t\t'title': 'blue line',\t\n  \t\t\t'valueField': 'Failed',\t\n  \t\t\t'useLineColorForBulletBorder': true,\t\n\t\t\t\t'lineColor':'#DF0C12',\t\n  \t\t\t'lineThickness': 3\t\n  \t\t},\t\n  \t\t{\t\n  \t\t\t'id': 'g3',\t\n  \t\t\t'balloonText': '[[category]]<br/><b><span style=\"font-size:14px;\">Skipped: [[value]]</span></b>',\t\n  \t\t\t'bullet': 'round',\t\n  \t\t\t'bulletBorderAlpha': 1,\t\n  \t\t\t'bulletColor': '#FFFFFF',\t\n  \t\t\t'hideBulletsCount': 50,\t\n  \t\t\t'title': 'blue line',\t\n  \t\t\t'valueField': 'Skipped',\t\n  \t\t\t'useLineColorForBulletBorder': true,\t\n\t\t\t\t'lineColor':'#F3F24D',\t\n  \t\t\t'lineThickness': 2\t\n  \t\t}],\t\n  \t\t\t\n  \t\t'chartCursor': {\t\n  \t\t},\t\n  \t\t'categoryField': 'displayname',\t\n  \t\t'categoryAxis': {\t\n  \t\t\t'parseDates': false,\t\n  \t\t\t'axisColor': '#DADADA',\t\n  \t\t\t'dashLength': 1,\t\n  \t\t\t'minorGridEnabled': true\t\n  \t\t},\t\n  \t   \t\n  \t}); \n \t\tchart.lineColorField = 'color';  \n      var chart2 = AmCharts.makeChart('myBarChart', { \n      \t'type': 'serial', \n      \t'categoryField': 'displayname', \n      \t'rotate': false, \n      \t'startDuration': 1, \n      \t'categoryAxis': { \n      \t\t'gridPosition': 'start', \n      \t\t'position': 'bottom' \n      \t}, \n      \t'trendLines': [], \n      \t'graphs': [ \n      \t\t{ \n      \t\t\t'balloonText': 'Passed:[[value]]', \n      \t\t\t'fillAlphas': 0.8, \n      \t\t\t'id': 'AmGraph-1', \n      \t\t\t'lineAlpha': 0.2, \n      \t\t\t'title': 'Passed', \n      \t\t\t'type': 'column', \n      \t\t\t'valueField': 'Passed',\t\n  \t\t\t'lineColor': '#0F9D28' \n      \t\t}, \n      \t\t{ \n      \t\t\t'balloonText': 'Failed:[[value]]', \n      \t\t\t'fillAlphas': 0.8, \n      \t\t\t'id': 'AmGraph-2', \n      \t\t\t'lineAlpha': 0.2, \n      \t\t\t'title': 'Failed', \n      \t\t\t'type': 'column',\t\n\t\t\t\t'lineColor':'#DF0C12', \n      \t\t\t'valueField': 'Failed' \n      \t\t}, \n                         { \n      \t\t\t'balloonText': 'Skipped:[[value]]', \n      \t\t\t'fillAlphas': 0.8, \n      \t\t\t'id': 'AmGraph-3', \n      \t\t\t'lineAlpha': 0.2, \n      \t\t\t'title': 'Skipped', \n      \t\t\t'type': 'column',\t\n\t\t\t\t'lineColor':'#F3F24D', \n      \t\t\t'valueField': 'Skipped' \n      \t\t} \n      \t], \n      \t'guides': [], \n      \t'valueAxes': [ \n      \t\t{ \n      \t\t\t'id': 'ValueAxis-1', \n      \t\t\t'position': 'left', \n      \t\t\t'axisAlpha': 0 \n      \t\t} \n      \t], \n      \t'allLabels': [], \n      \t'balloon': {}, \n      \t'titles': [], \n      \t'dataProvider': chartData \n      });\t\n  \t// generate some random data, quite different range\t\n  \tfunction generateChartData() {\t\n  \t\tvar chartData = [];\t\n  \t\tvar firstDate = new Date();\t\n  \t\tfirstDate.setDate(firstDate.getDate() - 5);\t\n  \t\tfor (var i = 0; i < 10; i++) {\t\n  \t\t\tvar newDate = 'RUN '+i;\t\n  \t\t\tvar visits = Math.round(Math.random() * (40 + i / 5)) + 20 + i;\t\n  \t\t\tvar failed = Math.round(Math.random() * (40 + i / 5)) + 20 + i;\t\n  \t\t\tvar skipped = Math.round(Math.random() * (40 + i / 5)) + 20 + i;\t\n  \t\t\tchartData.push({\t\n  \t\t\t\tdate: newDate,\t\n  \t\t\t\tPassed: visits,\t\n  \t\t\t\tFailed:failed,\t\n  \t\t\t\tSkipped:skipped\t\n  \t\t\t});\t\n  \t\t}\t\n  \t\treturn chartData;\t\n  \t} \n</script></td>\n            </tr>");
    }

    public static void printFooter(PrintWriter printWriter) {
        printWriter.println("\t\t\t<tr id=\"footer\">\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\tBest Viewed in &nbsp;\n\t\t\t\t\t\t\t\t<a href=\"http://www.mozilla.org/en-US/firefox/new/\">Firefox</a> &nbsp;\n\t\t\t\t\t\t\t\t<a href=\"http://www.apple.com/in/safari/\">Safari</a>&nbsp;\n\t\t\t\t\t\t\t\t<a href=\"http://www.google.com/chrome/\">Chrome</a>&nbsp;\n\t\t\t\t\t\t\t\t<a href=\"http://windows.microsoft.com/en-IN/internet-explorer/download-ie\">IE 9 & Above</a>&nbsp;\n\t\t\t\t\t\t\t&nbsp;\n\t\t\t\t\t\t\tNXG Reporter Version: v1.0.0&nbsp;\n\t\t\t\t\t\t\tReports by: <a href=\"http://seleniumbyneeds.blogspot.in/\">Selenium By Needs</a>\n\t\t\t\t\t</td>\n \t\t\t\t</tr>\n\t\t\t</table>\n\t\t</body>\n</html>");
    }
}
